# Demo 4: Implicit Deny
# Shows what happens when no matching Allow statement exists

policy_json: "policies/ec2-only-policy.json"

tests:
  - name: "EC2 DescribeInstances is allowed"
    action: "ec2:DescribeInstances"
    resource: "*"
    expect: "allowed"

  - name: "S3 GetObject is implicitly denied (no statement)"
    action: "s3:GetObject"
    resource: "arn:aws:s3:::my-bucket/data.txt"
    expect: "implicitDeny"

  - name: "IAM CreateUser is implicitly denied (no statement)"
    action: "iam:CreateUser"
    resource: "*"
    expect: "implicitDeny"

  - name: "Lambda InvokeFunction is implicitly denied (no statement)"
    action: "lambda:InvokeFunction"
    resource: "arn:aws:lambda:us-east-1:123456789012:function:my-function"
    expect: "implicitDeny"
