# Demo 5: Failure with Multiple SCPs
# Showcases politest's enhanced failure output when one SCP among many denies an action

policy_json: "policies/admin-policy.json"

scp_paths:
  - "scp/*.json"

tests:
  - name: "EC2 operations allowed (passes)"
    action: "ec2:RunInstances"
    resource: "*"
    expect: "allowed"

  - name: "S3 GetObject allowed (passes)"
    action: "s3:GetObject"
    resource: "arn:aws:s3:::my-bucket/data.txt"
    expect: "allowed"

  - name: "S3 DeleteObject denied by SCP (FAILS - showcases output)"
    action: "s3:DeleteObject"
    resource: "arn:aws:s3:::my-bucket/data.txt"
    expect: "allowed"  # We expect it to be allowed, but SCP denies it

  - name: "DynamoDB operations allowed (passes)"
    action: "dynamodb:PutItem"
    resource: "arn:aws:dynamodb:us-east-1:123456789012:table/MyTable"
    expect: "allowed"
