# FAILING TEST: Identity policy with IP-based explicit deny
# This test demonstrates the bug where identity policy failures show:
# ✓ Sid (e.g., DenyS3DeleteFromUntrustedNetwork)
# ✗ Line numbers in source file
# ✗ Statement content from source file
#
# After fix, should show complete source tracking like SCPs do

policy_json: "../policies/identity-conditional-denies.json"

tests:
  - name: "DeleteObject from untrusted IP (should show statement source)"
    action: "s3:DeleteObject"
    resource: "arn:aws:s3:::secure-bucket/sensitive.txt"
    context:
      - ContextKeyName: "aws:SourceIp"
        ContextKeyType: "string"
        ContextKeyValues: ["192.168.1.100"]
      - ContextKeyName: "aws:MultiFactorAuthPresent"
        ContextKeyType: "boolean"
        ContextKeyValues: ["true"]
    expect: "allowed"  # WRONG - will be explicitDeny
