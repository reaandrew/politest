# Test: Policy allows but SCP denies - using collection format
# Demonstrates how SCPs can override policy permissions

policy_json: "../policies/allow-s3.json"

scp_paths:
  - "../scp/permissive.json"
  - "../scp/deny-s3.json"

tests:
  - name: "GetObject denied by SCP even though policy allows"
    action: "s3:GetObject"
    resource: "arn:aws:s3:::test-bucket/*"
    expect: "explicitDeny"

  - name: "PutObject denied by SCP even though policy allows"
    action: "s3:PutObject"
    resource: "arn:aws:s3:::test-bucket/*"
    expect: "explicitDeny"

  - name: "ListBucket denied by SCP even though policy allows"
    action: "s3:ListBucket"
    resource: "arn:aws:s3:::test-bucket"
    expect: "explicitDeny"
