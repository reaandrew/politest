# Test: Policy has explicit Deny for delete actions
# Expected: Delete actions explicitDeny, read actions allowed

policy_json: "../policies/deny-s3-delete.json"

tests:
  - action: "s3:GetObject"
    resource: "arn:aws:s3:::test-bucket/*"
    expect: "allowed"

  - action: "s3:ListBucket"
    resource: "arn:aws:s3:::test-bucket/*"
    expect: "allowed"

  - action: "s3:DeleteObject"
    resource: "arn:aws:s3:::test-bucket/*"
    expect: "explicitDeny"

  - action: "s3:DeleteBucket"
    resource: "arn:aws:s3:::test-bucket/*"
    expect: "explicitDeny"
