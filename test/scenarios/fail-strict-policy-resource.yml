# Test fail scenario: Resource policy with non-IAM fields
# Expected to FAIL when used with --strict-policy flag
# Resource policy contains metadata fields that are not part of IAM schema

policy_json: "../policies/allow-s3.json"
resource_policy_json: "../policies/s3-resource-policy-with-metadata.json"
caller_arn: "arn:aws:iam::111111111111:user/alice"
resource_owner: "arn:aws:iam::222222222222:root"

tests:
  - name: "Should fail validation due to non-IAM fields in resource policy"
    action: "s3:GetObject"
    resource: "arn:aws:s3:::shared-bucket/data.txt"
    expect: "allowed"
