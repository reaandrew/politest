# Test: Policy allows EC2, one SCP denies EC2, one SCP allows all
# Expected: explicitDeny (SCP explicitly denies, all SCPs must allow)

policy_json: "../policies/allow-ec2.json"

scp_paths:
  - "../scp/permissive.json"
  - "../scp/deny-ec2.json"

tests:
  - action: "ec2:DescribeInstances"
    resource: "*"
    expect: "explicitDeny"

  - action: "ec2:StartInstances"
    resource: "*"
    expect: "explicitDeny"
